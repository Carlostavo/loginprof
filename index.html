<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portafolio de Videos - YouTube</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .slider-container {
            perspective: 1000px;
        }
        
        .slide-transition {
            transition: transform 0.7s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .thumbnail-card {
            transform-style: preserve-3d;
            transition: all 0.5s cubic-bezier(0.23, 1, 0.320, 1);
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.1);
        }
        
        .thumbnail-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        .thumbnail-card.active {
            transform: scale(1.05);
            box-shadow: 0 25px 50px -12px rgba(239, 68, 68, 0.3);
            border-color: #EF4444;
        }
        
        .dot-indicator {
            transition: all 0.3s cubic-bezier(0.23, 1, 0.320, 1);
            width: 12px;
            height: 12px;
        }
        
        .dot-indicator.active {
            width: 36px;
            background: linear-gradient(90deg, #EF4444, #F97316);
            transform: scale(1.2);
        }
        
        .glow-effect {
            position: relative;
        }
        
        .glow-effect::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #EF4444, #F97316, #EAB308, #EF4444);
            border-radius: inherit;
            z-index: -1;
            filter: blur(10px);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .glow-effect:hover::before {
            opacity: 0.6;
        }
        
        .badge-new {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            animation: pulse-glow 2s infinite;
        }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 5px #EF4444; }
            50% { box-shadow: 0 0 20px #EF4444; }
        }
        
        .loading-shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .slide-enter {
            animation: slideIn 0.5s ease forwards;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .stats-card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.85);
        }
        
        .channel-avatar {
            border: 3px solid transparent;
            background: linear-gradient(45deg, #EF4444, #F97316) border-box;
            mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
        }
        
        .hover-lift {
            transition: transform 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-3px);
        }
        
        .grid-pattern {
            background-image: 
                linear-gradient(rgba(0, 0, 0, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 md:py-12 max-w-7xl">
        <!-- Header -->
        <div class="text-center mb-12 md:mb-16 slide-enter">
            <div class="inline-flex items-center justify-center mb-6">
                <div class="channel-avatar w-16 h-16 rounded-full overflow-hidden mr-4">
                    <div class="w-full h-full bg-gradient-to-br from-red-500 to-orange-500 flex items-center justify-center">
                        <i class="fab fa-youtube text-white text-2xl"></i>
                    </div>
                </div>
                <div class="text-left">
                    <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Portafolio de Videos</h1>
                    <p class="text-gray-600">Galería profesional actualizada automáticamente</p>
                </div>
            </div>
            
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl mx-auto mb-8">
                <div class="stats-card rounded-xl p-4 shadow-sm hover-lift">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-play text-red-600"></i>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Total Videos</p>
                            <p id="total-videos" class="text-xl font-bold text-gray-900">0</p>
                        </div>
                    </div>
                </div>
                
                <div class="stats-card rounded-xl p-4 shadow-sm hover-lift">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-sync-alt text-green-600"></i>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Actualización</p>
                            <p id="update-status" class="text-xl font-bold text-gray-900">Activa</p>
                        </div>
                    </div>
                </div>
                
                <div class="stats-card rounded-xl p-4 shadow-sm hover-lift">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-clock text-blue-600"></i>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Última Actual.</p>
                            <p id="last-update" class="text-xl font-bold text-gray-900">--:--</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Slider Container -->
        <div class="slide-enter">
            <div class="slider-container relative mb-8">
                <!-- Navigation Arrows -->
                <button id="prev-btn" class="absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 md:-translate-x-8 z-20 w-12 h-12 bg-white rounded-full shadow-xl flex items-center justify-center text-gray-700 hover:text-red-600 hover:shadow-2xl transition-all duration-300 glow-effect">
                    <i class="fas fa-chevron-left"></i>
                </button>
                
                <button id="next-btn" class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 md:translate-x-8 z-20 w-12 h-12 bg-white rounded-full shadow-xl flex items-center justify-center text-gray-700 hover:text-red-600 hover:shadow-2xl transition-all duration-300 glow-effect">
                    <i class="fas fa-chevron-right"></i>
                </button>
                
                <!-- Slides Container -->
                <div class="overflow-hidden rounded-2xl bg-white/50 backdrop-blur-sm p-2">
                    <div class="flex slide-transition py-4" id="slider">
                        <!-- Slides will be loaded here -->
                        <div class="w-full flex-shrink-0 px-2">
                            <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4" id="thumbnails-grid">
                                <!-- Loading state -->
                                <div class="col-span-full">
                                    <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                                        <div class="thumbnail-card rounded-xl overflow-hidden">
                                            <div class="loading-shimmer h-40 rounded-lg"></div>
                                            <div class="p-4">
                                                <div class="loading-shimmer h-4 rounded mb-2"></div>
                                                <div class="loading-shimmer h-3 w-24 rounded"></div>
                                            </div>
                                        </div>
                                        <!-- Repeat loading cards -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dot Indicators -->
            <div class="flex justify-center items-center space-x-3 mb-10" id="dot-indicators">
                <!-- Dots will be generated here -->
            </div>

            <!-- Current Video Info -->
            <div id="current-video-info" class="max-w-3xl mx-auto mb-10 opacity-0 transition-opacity duration-500">
                <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-gray-200">
                    <div class="flex items-start justify-between mb-4">
                        <div>
                            <div class="flex items-center mb-2">
                                <h2 id="current-video-title" class="text-xl md:text-2xl font-bold text-gray-900 mr-3">Selecciona un video</h2>
                                <span id="new-badge" class="badge-new text-xs text-white px-3 py-1 rounded-full hidden">NUEVO</span>
                            </div>
                            <div class="flex items-center text-gray-600 space-x-4">
                                <span id="current-video-date" class="flex items-center">
                                    <i class="far fa-calendar mr-2"></i>
                                    <span>-- --- ----</span>
                                </span>
                                <span id="video-number" class="flex items-center">
                                    <i class="fas fa-hashtag mr-2"></i>
                                    <span>0/0</span>
                                </span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <a id="youtube-link" href="#" target="_blank" 
                               class="w-10 h-10 bg-red-600 hover:bg-red-700 text-white rounded-full flex items-center justify-center transition-colors hover-lift">
                                <i class="fab fa-youtube"></i>
                            </a>
                        </div>
                    </div>
                    <p id="current-video-description" class="text-gray-700 line-clamp-3">Selecciona un video de la galería para ver su descripción</p>
                </div>
            </div>

            <!-- Controls -->
            <div class="flex flex-wrap justify-center items-center gap-4 mb-12">
                <button id="auto-slide-toggle" 
                        class="px-6 py-3 bg-gradient-to-r from-gray-800 to-gray-900 text-white rounded-xl hover:shadow-lg transition-all duration-300 hover-lift flex items-center">
                    <i class="fas fa-play-circle mr-2"></i>
                    <span>Auto Slide:</span>
                    <span id="auto-slide-status" class="font-bold ml-2">ON</span>
                </button>
                
                <button id="refresh-btn" 
                        class="px-6 py-3 bg-white text-gray-700 border border-gray-300 rounded-xl hover:bg-gray-50 hover:shadow-lg transition-all duration-300 hover-lift flex items-center">
                    <i class="fas fa-sync-alt mr-2"></i>
                    Actualizar Galería
                </button>
                
                <div class="flex items-center bg-white rounded-xl px-4 py-2 border border-gray-300">
                    <i class="fas fa-tachometer-alt text-gray-500 mr-2"></i>
                    <span class="text-sm text-gray-600 mr-2">Velocidad:</span>
                    <select id="speed-select" class="bg-transparent border-none focus:outline-none">
                        <option value="5000">Normal</option>
                        <option value="3000">Rápido</option>
                        <option value="7000">Lento</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center text-gray-500 text-sm border-t border-gray-200 pt-8 mt-8 slide-enter">
            <p class="mb-2">Conectado al canal: <span class="font-mono text-gray-700">UC1T2hmhZojOKVts22YOZvrQ</span></p>
            <p class="flex items-center justify-center">
                <i class="fas fa-satellite-dish text-red-500 mr-2"></i>
                <span>Actualización automática cada 60 segundos</span>
            </p>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notification-toast" class="fixed bottom-4 right-4 z-50 transform translate-y-20 opacity-0 transition-all duration-500">
        <div class="bg-gray-900 text-white px-6 py-4 rounded-xl shadow-2xl max-w-sm">
            <div class="flex items-center">
                <div id="notification-icon" class="mr-3"></div>
                <div>
                    <p id="notification-message" class="font-medium"></p>
                    <p id="notification-time" class="text-gray-400 text-sm mt-1"></p>
                </div>
                <button onclick="hideNotification()" class="ml-4 text-gray-400 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Configuración
        const CONFIG = {
            channelId: 'UC1T2hmhZojOKVts22YOZvrQ',
            maxVideos: 15,
            slidesPerView: 5,
            autoSlideInterval: 5000,
            updateCheckInterval: 60000,
            videosPerSlide: 5 // Miniaturas por slide
        };

        // Estado
        let videos = [];
        let currentSlideIndex = 0;
        let totalSlides = 0;
        let autoSlideEnabled = true;
        let autoSlideTimer;
        let updateTimer;

        // Elementos DOM
        const elements = {
            slider: document.getElementById('slider'),
            dotsContainer: document.getElementById('dot-indicators'),
            thumbnailsGrid: document.getElementById('thumbnails-grid'),
            prevBtn: document.getElementById('prev-btn'),
            nextBtn: document.getElementById('next-btn'),
            autoSlideToggle: document.getElementById('auto-slide-toggle'),
            autoSlideStatus: document.getElementById('auto-slide-status'),
            refreshBtn: document.getElementById('refresh-btn'),
            speedSelect: document.getElementById('speed-select'),
            totalVideos: document.getElementById('total-videos'),
            updateStatus: document.getElementById('update-status'),
            lastUpdate: document.getElementById('last-update'),
            currentVideoInfo: document.getElementById('current-video-info'),
            currentVideoTitle: document.getElementById('current-video-title'),
            currentVideoDate: document.getElementById('current-video-date'),
            currentVideoDescription: document.getElementById('current-video-description'),
            youtubeLink: document.getElementById('youtube-link'),
            newBadge: document.getElementById('new-badge'),
            videoNumber: document.getElementById('video-number'),
            notificationToast: document.getElementById('notification-toast'),
            notificationMessage: document.getElementById('notification-message'),
            notificationTime: document.getElementById('notification-time'),
            notificationIcon: document.getElementById('notification-icon')
        };

        // 1. Inicializar
        async function init() {
            await loadVideos();
            setupEventListeners();
            startAutoSlide();
            startUpdateChecker();
            
            // Animación inicial
            setTimeout(() => {
                elements.currentVideoInfo.style.opacity = '1';
            }, 500);
        }

        // 2. Cargar videos
        async function loadVideos() {
            try {
                showLoading(true);
                
                const proxyUrl = 'https://api.allorigins.win/get?url=';
                const rssUrl = `https://www.youtube.com/feeds/videos.xml?channel_id=${CONFIG.channelId}`;
                const encodedUrl = encodeURIComponent(rssUrl);
                
                const response = await fetch(proxyUrl + encodedUrl);
                const data = await response.json();
                
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(data.contents, "text/xml");
                const entries = xmlDoc.getElementsByTagName('entry');
                
                videos = [];
                for (let i = 0; i < Math.min(entries.length, CONFIG.maxVideos); i++) {
                    const entry = entries[i];
                    const videoId = entry.getElementsByTagName('yt:videoId')[0].textContent;
                    const title = entry.getElementsByTagName('title')[0].textContent;
                    const published = entry.getElementsByTagName('published')[0].textContent;
                    const description = entry.getElementsByTagName('media:description')[0]?.textContent || '';
                    
                    videos.push({
                        id: videoId,
                        title: title,
                        description: description.substring(0, 150) + (description.length > 150 ? '...' : ''),
                        publishedAt: new Date(published),
                        thumbnail: `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`,
                        isNew: isVideoNew(published),
                        daysAgo: getDaysAgo(published),
                        index: i + 1
                    });
                }
                
                renderSlides();
                updateStats();
                showNotification('Galería actualizada', 'check');
                
                showLoading(false);
                updateLastUpdateTime();
                
            } catch (error) {
                console.error('Error cargando videos:', error);
                showError('Error al cargar videos');
                showNotification('Error de conexión', 'error');
            }
        }

        // 3. Renderizar slides y miniaturas
        function renderSlides() {
            elements.thumbnailsGrid.innerHTML = '';
            elements.dotsContainer.innerHTML = '';
            
            totalSlides = Math.ceil(videos.length / CONFIG.videosPerSlide);
            
            // Crear miniaturas en grid
            videos.forEach((video, index) => {
                const thumbContainer = document.createElement('div');
                thumbContainer.className = `thumbnail-card rounded-xl overflow-hidden bg-white cursor-pointer border-2 border-transparent ${
                    index === 0 ? 'active' : ''
                }`;
                
                thumbContainer.innerHTML = `
                    <div class="relative overflow-hidden">
                        <img src="${video.thumbnail}" 
                             alt="${video.title}"
                             class="w-full h-48 object-cover transition-transform duration-500 hover:scale-110"
                             loading="lazy"
                             onerror="this.src='https://images.unsplash.com/photo-1499364615650-ec38552f4f34?auto=format&fit=crop&w=500&q=80'">
                        <div class="absolute top-3 right-3">
                            ${video.isNew ? 
                                '<span class="badge-new text-xs text-white px-2 py-1 rounded-full">NUEVO</span>' : 
                                ''}
                        </div>
                        <div class="absolute bottom-3 left-3">
                            <span class="bg-black/70 text-white text-xs px-2 py-1 rounded">#${video.index}</span>
                        </div>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                            <div class="bg-red-600 text-white p-3 rounded-full">
                                <i class="fab fa-youtube"></i>
                            </div>
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-900 mb-2 line-clamp-2 text-sm">${video.title}</h3>
                        <div class="flex justify-between items-center text-xs text-gray-500">
                            <span class="flex items-center">
                                <i class="far fa-clock mr-1"></i>
                                ${video.daysAgo}
                            </span>
                            <button class="text-red-600 hover:text-red-700">
                                <i class="fas fa-external-link-alt"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                thumbContainer.addEventListener('click', () => selectVideo(index));
                elements.thumbnailsGrid.appendChild(thumbContainer);
            });
            
            // Crear dots indicators
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('span');
                dot.className = `dot-indicator rounded-full cursor-pointer ${
                    i === currentSlideIndex ? 'active' : 'bg-gray-300 hover:bg-gray-400'
                }`;
                dot.addEventListener('click', () => goToSlide(i));
                elements.dotsContainer.appendChild(dot);
            }
            
            // Mostrar primer video seleccionado
            if (videos.length > 0) {
                selectVideo(0);
            }
            
            updateSliderPosition();
        }

        // 4. Navegación
        function goToSlide(slideIndex) {
            if (slideIndex < 0 || slideIndex >= totalSlides) return;
            
            currentSlideIndex = slideIndex;
            updateSliderPosition();
            updateDots();
            restartAutoSlide();
        }

        function updateSliderPosition() {
            if (totalSlides > 1) {
                const slideWidth = 100 / totalSlides;
                const translateX = currentSlideIndex * slideWidth;
                elements.slider.style.transform = `translateX(-${translateX}%)`;
            }
        }

        function updateDots() {
            document.querySelectorAll('#dot-indicators .dot-indicator').forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlideIndex);
                dot.classList.toggle('bg-gray-300', !(index === currentSlideIndex));
            });
        }

        function nextSlide() {
            const nextIndex = (currentSlideIndex + 1) % totalSlides;
            goToSlide(nextIndex);
        }

        function prevSlide() {
            const prevIndex = (currentSlideIndex - 1 + totalSlides) % totalSlides;
            goToSlide(prevIndex);
        }

        // 5. Seleccionar video
        function selectVideo(index) {
            if (!videos[index]) return;
            
            const video = videos[index];
            
            // Actualizar info del video
            elements.currentVideoTitle.textContent = video.title;
            elements.currentVideoDate.innerHTML = `<i class="far fa-calendar mr-2"></i><span>${formatFullDate(video.publishedAt)}</span>`;
            elements.currentVideoDescription.textContent = video.description || 'Sin descripción disponible';
            elements.youtubeLink.href = `https://youtube.com/watch?v=${video.id}`;
            elements.newBadge.classList.toggle('hidden', !video.isNew);
            elements.videoNumber.innerHTML = `<i class="fas fa-hashtag mr-2"></i><span>${video.index}/${videos.length}</span>`;
            
            // Actualizar miniaturas activas
            document.querySelectorAll('.thumbnail-card').forEach((card, idx) => {
                card.classList.toggle('active', idx === index);
            });
            
            // Animación
            elements.currentVideoInfo.style.opacity = '0';
            setTimeout(() => {
                elements.currentVideoInfo.style.opacity = '1';
            }, 150);
        }

        // 6. Auto-slide
        function startAutoSlide() {
            if (autoSlideEnabled && totalSlides > 1) {
                autoSlideTimer = setInterval(nextSlide, CONFIG.autoSlideInterval);
            }
        }

        function toggleAutoSlide() {
            autoSlideEnabled = !autoSlideEnabled;
            elements.autoSlideStatus.textContent = autoSlideEnabled ? 'ON' : 'OFF';
            elements.autoSlideStatus.classList.toggle('text-green-500', autoSlideEnabled);
            elements.autoSlideStatus.classList.toggle('text-red-500', !autoSlideEnabled);
            
            if (autoSlideEnabled) {
                startAutoSlide();
                showNotification('Auto-slide activado', 'play');
            } else {
                clearInterval(autoSlideTimer);
                showNotification('Auto-slide desactivado', 'pause');
            }
        }

        function restartAutoSlide() {
            clearInterval(autoSlideTimer);
            if (autoSlideEnabled) {
                startAutoSlide();
            }
        }

        // 7. Actualizaciones automáticas
        function startUpdateChecker() {
            updateTimer = setInterval(async () => {
                try {
                    const proxyUrl = 'https://api.allorigins.win/get?url=';
                    const rssUrl = `https://www.youtube.com/feeds/videos.xml?channel_id=${CONFIG.channelId}`;
                    const encodedUrl = encodeURIComponent(rssUrl);
                    
                    const response = await fetch(proxyUrl + encodedUrl);
                    const data = await response.json();
                    
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(data.contents, "text/xml");
                    const entries = xmlDoc.getElementsByTagName('entry');
                    
                    if (entries.length > 0) {
                        const latestVideoId = entries[0].getElementsByTagName('yt:videoId')[0].textContent;
                        
                        if (videos.length === 0 || videos[0].id !== latestVideoId) {
                            console.log('Nuevo video detectado, actualizando...');
                            await loadVideos();
                        }
                    }
                } catch (error) {
                    console.error('Error en verificación:', error);
                }
            }, CONFIG.updateCheckInterval);
        }

        // 8. Event Listeners
        function setupEventListeners() {
            elements.prevBtn.addEventListener('click', prevSlide);
            elements.nextBtn.addEventListener('click', nextSlide);
            elements.autoSlideToggle.addEventListener('click', toggleAutoSlide);
            elements.refreshBtn.addEventListener('click', () => loadVideos());
            elements.speedSelect.addEventListener('change', (e) => {
                CONFIG.autoSlideInterval = parseInt(e.target.value);
                restartAutoSlide();
                showNotification(`Velocidad actualizada`, 'settings');
            });
            
            // Teclado
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowLeft') prevSlide();
                if (e.key === 'ArrowRight') nextSlide();
                if (e.key === ' ') {
                    e.preventDefault();
                    toggleAutoSlide();
                }
            });
            
            // Swipe
            let touchStartX = 0;
            let touchEndX = 0;
            
            elements.slider.parentElement.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
            });
            
            elements.slider.parentElement.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            });
            
            function handleSwipe() {
                const swipeThreshold = 50;
                const diff = touchStartX - touchEndX;
                
                if (Math.abs(diff) > swipeThreshold) {
                    if (diff > 0) {
                        nextSlide();
                    } else {
                        prevSlide();
                    }
                }
            }
        }

        // 9. Funciones auxiliares
        function isVideoNew(publishedDate) {
            const published = new Date(publishedDate);
            const now = new Date();
            const daysDiff = (now - published) / (1000 * 60 * 60 * 24);
            return daysDiff < 7;
        }

        function getDaysAgo(publishedDate) {
            const published = new Date(publishedDate);
            const now = new Date();
            const diffMs = now - published;
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return 'Hoy';
            if (diffDays === 1) return 'Ayer';
            if (diffDays < 7) return `${diffDays}d`;
            if (diffDays < 30) return `${Math.floor(diffDays/7)} sem`;
            return `${Math.floor(diffDays/30)} mes`;
        }

        function formatFullDate(date) {
            return date.toLocaleDateString('es-ES', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function updateStats() {
            elements.totalVideos.textContent = videos.length;
            elements.updateStatus.textContent = 'Activa';
            elements.updateStatus.classList.add('text-green-600');
        }

        function updateLastUpdateTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('es-ES', {
                hour: '2-digit',
                minute: '2-digit'
            });
            elements.lastUpdate.textContent = timeStr;
        }

        function showLoading(show) {
            if (show) {
                elements.thumbnailsGrid.innerHTML = `
                    <div class="col-span-full">
                        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                            ${Array.from({length: 5}).map(() => `
                                <div class="thumbnail-card rounded-xl overflow-hidden">
                                    <div class="loading-shimmer h-48 rounded-lg"></div>
                                    <div class="p-4">
                                        <div class="loading-shimmer h-4 rounded mb-2"></div>
                                        <div class="loading-shimmer h-3 w-24 rounded"></div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
        }

        function showError(message) {
            elements.thumbnailsGrid.innerHTML = `
                <div class="col-span-full text-center py-12">
                    <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-exclamation-triangle text-red-600 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Error de conexión</h3>
                    <p class="text-gray-600 mb-4">${message}</p>
                    <button onclick="loadVideos()" 
                            class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
                        Reintentar
                    </button>
                </div>
            `;
        }

        function showNotification(message, type = 'info') {
            const icons = {
                check: '<div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center"><i class="fas fa-check text-green-600"></i></div>',
                error: '<div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center"><i class="fas fa-exclamation text-red-600"></i></div>',
                play: '<div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center"><i class="fas fa-play text-blue-600"></i></div>',
                pause: '<div class="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center"><i class="fas fa-pause text-yellow-600"></i></div>',
                settings: '<div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center"><i class="fas fa-cog text-purple-600"></i></div>',
                info: '<div class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center"><i class="fas fa-info text-gray-600"></i></div>'
            };
            
            elements.notificationIcon.innerHTML = icons[type] || icons.info;
            elements.notificationMessage.textContent = message;
            elements.notificationTime.textContent = new Date().toLocaleTimeString('es-ES', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Mostrar notificación
            elements.notificationToast.style.transform = 'translateY(0)';
            elements.notificationToast.style.opacity = '1';
            
            // Auto-ocultar
            setTimeout(hideNotification, 5000);
        }

        function hideNotification() {
            elements.notificationToast.style.transform = 'translateY(20px)';
            elements.notificationToast.style.opacity = '0';
        }

        // 10. Inicializar
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
